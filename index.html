<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
    <link href="favicon.ico" rel="shortcut icon">
	<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport">
	<title>A fun little JS game</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <style type="text/css">
		::-webkit-scrollbar {width: 8px;height: 8px;background-color: #001}
		::-webkit-scrollbar-thumb {background: #E83239;border-radius: 8px}
		* {box-sizing: border-box;}
		html,body {height: 100%;padding: 0;margin: 0;}
		body {background: black;min-height: 100%;font-size: 20px;font-family: "Arial", sans-serif;overflow-x: hidden;overflow-y: scroll;}
		.wrap {position: relative;height: 100%;min-height: 500px;padding-bottom: 20px;}
		.game {-webkit-transform-style: preserve-3d;transform-style: preserve-3d;-webkit-perspective: 500px;perspective: 500px;min-height: 100%;height: 100%;}
		@-webkit-keyframes matchAnim { 0% {background: #bcffcc;} 100% {background: black;} }
		@keyframes matchAnim { 0% {background: #bcffcc;} 100% {background: black;} }
		.card {float: left;width: 16.66666%;height: 25%;padding: 5px;text-align: center;display: block;-webkit-perspective: 500px;perspective: 500px;position: relative;cursor: pointer;z-index: 50;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}
		@media(max-width:800px) { .card {width: 33.33%;height: 20%;} }
		@media screen and (max-width:800px) and (orientation:landscape) { .card {width: 20%;height: 35%;} }
		.card .inside {width: 100%;height: 100%;display: block;-webkit-transform-style: preserve-3d;transform-style: preserve-3d;-webkit-transition: .4s ease-in-out;transition: .25s ease-in-out;background: black;}
		.card .inside.picked,.card .inside.matched {-webkit-transform: rotateY(180deg);transform: rotateY(180deg);}
		.card .inside.matched {-webkit-animation: 1s matchAnim ease-in-out;animation: 1s matchAnim ease-in-out;-webkit-animation-delay: .4s;animation-delay: .4s;}
		.card .front,.card .back {-webkit-backface-visibility: hidden;backface-visibility: hidden;position: absolute;top: 0;left: 0;width: 100%;height: 100%;padding: 5px;}
		.card .front img,.card .back img {max-width: 100%;display: block;margin: 0 auto;max-height: 100%;filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.5));}
		.card .front {-webkit-transform: rotateY(-180deg);transform: rotateY(-180deg);}
		@media(max-width:800px) { .card .front {padding: 5px;} }
		.card .back {-webkit-transform: rotateX(0);transform: rotateX(0);}
		@media(max-width:800px) { .card .back {padding: 10px;} }
		.modal-overlay,.intro-modal-overlay {background: #10151b;position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: 999999;}
		.modal-overlay {display: none;background: #10151b77;}
		.modal,.intro-modal {position: relative;width: 500px;height: 400px;max-height: 90%;max-width: 90%;min-height: 380px;margin: 0 auto;top: 50%;-webkit-transform: translateY(-50%);transform: translateY(-50%);padding: 30px 10px;color: lavender;}
		.intro-modal p {text-align: center;}
		.closeBtn {font-size: 48px;line-height: 0;float: right;cursor: pointer;text-decoration: none;}
		.closeBtn:hover,.closeBtn:focus {color: #ffffff;}
		h2 {margin: 20px 0;}
		a {color: inherit;text-underline-position: under;}
		li {margin-block-start: 1em;margin-block-end: 1em;}
		.modal .winner {font-size: 80px;text-align: center;color: #f1f1f1;text-shadow: 0px 3px 0 #123456;}
		@media(max-width:480px) { .modal .winner {font-size: 60px;} }
		.modal .restart {padding: 15px 30px;display: block;font-size: 30px;border: none;background: #f1f1f1;background: -webkit-gradient(linear, left top, left bottom, from(#f1f1f1), to(#654321));background: linear-gradient(#353232, #654321);border: 1px solid #654321;border-radius: 5px;color: #f1f1f1;text-shadow: 0px 1px 0 #123456;cursor: pointer;position: absolute;bottom: 30px;left: 50%;transform: translateX(-50%);outline: none;}
		.modal .restart:hover {background: -webkit-gradient(linear, left top, left bottom, from(#654321), to(#123456));background: linear-gradient(#654321, #123456);}
    </style>
</head>

<body>
	<div class="intro-modal-overlay">
		<div class="intro-modal">
			<a class="closeBtn" href="javascript:void(0)">&times;</a>
			<h2>Welcome</h2>
			<ul>
				<li>Click on the cards to reveal them</li>
				<li>Only two cards can be revealed at a time</li>
				<li>If the revealed cards are matched, they remain open</li>
				<li>Open all the cards to win</li>
				<li>Cards shuffle every time using <a href="https://bost.ocks.org/mike/shuffle/">Fisher-Yates Algorithm</a></li>
			</ul>
			<p>Best of Luck &#x1f44d;</p>
		</div>
	</div>

    <div class="wrap">
        <div class="game"></div>

        <div class="modal-overlay">
            <div class="modal">
                <h2 class="winner">You Rock!</h2>
                <button class="restart">Play Again?</button>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    let startTime, endTime;
	(function () {
	    var Memory = {
	        init: function (cards) {
	            this.$game = $(".game");
	            this.$modal = $(".modal");
	            this.$overlay = $(".modal-overlay");
	            this.$restartButton = $("button.restart");
	            this.cardsArray = $.merge(cards, cards);
	            this.shuffleCards(this.cardsArray);
	            this.setup();
	        },
	        shuffleCards: function (cardsArray) {
	            this.$cards = $(this.shuffle(this.cardsArray));
	        },
	        setup: function () {
	            this.html = this.buildHTML();
	            this.$game.html(this.html);
	            this.$memoryCards = $(".card");
	            this.paused = false;
	            this.guess = null;
	            this.binding();
	        },
	        binding: function () {
	            this.$memoryCards.on("click", this.cardClicked);
	            this.$restartButton.on("click", $.proxy(this.reset, this));
	        },
	        cardClicked: function () {
	            var _ = Memory;
	            var $card = $(this);
	            if (!_.paused && !$card.find(".inside").hasClass("matched") && !$card.find(".inside").hasClass("picked")) {
	                $card.find(".inside").addClass("picked");
	                if (!_.guess) {
	                    _.guess = $(this).attr("data-id");
	                } else if (_.guess == $(this).attr("data-id") && !$(this).hasClass("picked")) {
	                    $(".picked").addClass("matched");
	                    _.guess = null;
	                } else {
	                    _.guess = null;
	                    _.paused = true;
	                    setTimeout(function () {
	                        $(".picked").removeClass("picked");
	                        Memory.paused = false;
	                    }, 500);
	                }
	                if ($(".matched").length == $(".card").length) {
	                    _.win();
	                }
	            }
	        },
	        win: function () {
	            this.paused = true;
	            setTimeout(function () {
	                Memory.showModal();
	                Memory.$game.fadeOut();
	            }, 1500);
	        },
	        showModal: function () {
	            this.$overlay.show();
	            this.$modal.fadeIn("slow");
	        },
	        hideModal: function () {
	            this.$overlay.hide();
	            this.$modal.hide();
	        },
	        reset: function () {
	            this.hideModal();
	            this.shuffleCards(this.cardsArray);
	            this.setup();
	            this.$game.show("slow");
	        },

	        // Fisher--Yates Algorithm -- https://bost.ocks.org/mike/shuffle/
	        shuffle: function (array) {
	            var counter = array.length, temp, index;
	            while (counter > 0) {
	                index = Math.floor(Math.random() * counter);
	                counter--;
	                temp = array[counter];
	                array[counter] = array[index];
	                array[index] = temp;
	            }
	            return array;
	        },
	        buildHTML: function () {
	            var frag = '';
	            this.$cards.each(function (k, v) {
	                frag += '<div class="card" data-id="' + v.id + '"><div class="inside">\
	                            <div class="front"><img src="'+ v.img + '" alt="'+ v.name + '" /></div>\
	                            <div class="back"><img src="assets/Avengers.jpg" alt="Codepen" /></div></div>\
	                        </div>';
	            });
	            return frag;
	        }
	    };

	    var cards = [
	        {
	            name: "IronMan",
	            img: "assets/IronMan.png",
	            id: 1,
	        },
	        {
	            name: "CaptainAmerica",
	            img: "assets/CaptainAmerica.png",
	            id: 2
	        },
	        {
	            name: "Thor",
	            img: "assets/Thor.png",
	            id: 3
	        },
	        {
	            name: "Hulk",
	            img: "assets/Hulk.png",
	            id: 4
	        },
	        {
	            name: "BlackWidow",
	            img: "assets/BlackWidow.png",
	            id: 5
	        },
	        {
	            name: "DoctorStrange",
	            img: "assets/DoctorStrange.png",
	            id: 6
	        },
	        {
	            name: "Vision",
	            img: "assets/Vision.png",
	            id: 7
	        },
	        {
	            name: "ScarletWitch",
	            img: "assets/ScarletWitch.png",
	            id: 8
	        },
	        {
	            name: "WarMachine",
	            img: "assets/WarMachine.png",
	            id: 9
	        },
	        {
	            name: "SpiderMan",
	            img: "assets/SpiderMan.png",
	            id: 10
	        },
	        {
	            name: "Rocket",
	            img: "assets/Rocket.png",
	            id: 11
	        },
	        {
	            name: "StarLord",
	            img: "assets/StarLord.png",
	            id: 12
	        },
	    ];
	    Memory.init(cards);
	    Memory.win();

	    document.querySelector(".closeBtn").onclick = function(e) {
	        e.preventDefault()
	        console.log(this.parentElement.parentElement.remove())
	        startTime = new Date()
	    }

	})();
    </script>
</body>

</html>